metadata:
  version: 1
sources:  
    stanford_shorelines:
        driver: shapefile
        description: Stanford shoreline data
        url: https://earthworks.stanford.edu/catalog/stanford-vt021tk4894
        args:
          urlpath: gs://calitp-analytics-data/data-analyses/msd_dashboard_metric/stanford_shorelines.zip
          use_fsspec: true
    ca_boundary:
        driver: geoparquet
        description: CA boundary
        args:
          urlpath: gs://calitp-analytics-data/data-analyses/high_quality_transit_areas/ca_boundary.parquet
    ## INTERMEDIATE DATA
    # Source: A2_combine.py
    rail_brt_ferry_initial:
        driver: geoparquet
        description: Rail / BRT / Ferry points created in A2_combine.py
        args:
          urlpath: gs://calitp-analytics-data/data-analyses/high_quality_transit_areas/rail_brt_ferry.parquet
    # Source: B2_combine_operator_corridors.py
    all_bus:
        driver: geoparquet
        description: Combined corridors across all operators. Created in B2_combine_operators_corridors.py.
        args:
          urlpath: gs://calitp-analytics-data/data-analyses/high_quality_transit_areas/intermediate/all_bus.parquet  
    # Source: C1_prep_for_clipping.py
    pairwise_intersections:
        driver: geoparquet
        description: Use dask_geopandas.sjoin to find which hqta segments do intersect at some point. Created in C1_prep_for_clipping.py. 
        args:
          urlpath: gs://calitp-analytics-data/data-analyses/high_quality_transit_areas/intermediate/pairwise.parquet   
    # Source: C1_prep_for_clipping.py
    subset_corridors:
        driver: geoparquet
        description: Narrow down `all_bus` to hqta segments that are found in `pairwise_intersections`. Created in C1_prep_for_clipping.py.
        args:
          urlpath: gs://calitp-analytics-data/data-analyses/high_quality_transit_areas/intermediate/subset_corridors.parquet 
    # Source: C2_clip_bus_intersections.py
    combined_clipped_intersections:
        driver: geoparquet
        description: Combine all the bus intersections (clipped) geometries into one file. Created in C2_clip_bus_intersections.py.
        args:
          urlpath: gs://calitp-analytics-data/data-analyses/high_quality_transit_areas/all_clipped.parquet
    # Source: C4_create_bus_hqta_types.py
    major_stop_bus:
        driver: geoparquet
        description: Bus stops that are within the bus intersections (clipped and exploded). Created in C4_create_bus_hqta_types.py.
        args:
          urlpath: ./data/major_stop_bus.parquet
    stops_in_hq_corr:
        driver: geoparquet
        description: Bus stops that are within the HQ corridors, even if they stops themselves do not have a lot of trips pass through. Created in C4_create_bus_hqta_types.py.
        args:
          urlpath: ./data/stops_in_hq_corr.parquet
    ## FINAL DATA
    # Source: D1_assemble_hqta_points
    hqta_points:
        driver: geoparquet
        description: Combined point data for all HQTA types. Created in D1_assemble_hqta_points.py.
        args:
          urlpath: gs://calitp-analytics-data/data-analyses/high_quality_transit_areas/hqta_points.parquet
    # Source: D2_assemble_hqta_polygons
    hqta_areas:
        driver: geoparquet
        description: Combined polygon data for all HQTA types. Created in D2_assemble_hqta_polygons.py.
        args:
          urlpath: gs://calitp-analytics-data/data-analyses/high_quality_transit_areas/hqta_polygons.parquet