metadata:
  version: 1
  parameters:
    analysis_date:
      type: str
      description: Analysis date, specified in update_vars.py
      default: "2023-10-11" 
sources:
  route_df:
    driver: geoparquet
    description: Route-level df with Caltrans district, route_length, and route service hours.
    args:
      # source: A1_schedule_route_level_df.py
      urlpath: gs://calitp-analytics-data/data-analyses/bus_service_increase/routes_{{analysis_date}}.parquet 
  routes_on_shn:
    driver: geoparquet
    description: Each row is route_id-Hwy Route combination. The transit routes that meet criteria for being categorized as `on_shn` is flagged as 1, all else are zero. Can adjust thresholds later.
    args:
      # source: A2_generate_routes_on_shn_data.py
      urlpath: gs://calitp-analytics-data/data-analyses/bus_service_increase/routes_on_shn_{{analysis_date}}.parquet 
  parallel_or_intersecting_routes:
    driver: geoparquet
    description: Each row is route_id-Hwy Route combination. The transit routes that meet criteria for being categorized as `intersecting_shn` is flagged as 1, all else are zero. Can adjust thresholds later.
    args:
      # source: A2_generate_routes_on_shn_data.py
      urlpath: gs://calitp-analytics-data/data-analyses/bus_service_increase/parallel_or_intersecting_{{analysis_date}}.parquet 
  routes_categorized:
    driver: geoparquet
    description: Routes categorized into mutually exclusive groups. on_shn, intersects_shn, other. The transit route line geometry is also provided.
    args:
      # source: A3_categorize_routes.py
      urlpath: gs://calitp-analytics-data/data-analyses/bus_service_increase/routes_categorized_{{analysis_date}}.parquet 
  routes_categorized_with_speed:
    driver: geoparquet
    description: Route-level service hours, speeds, category, and line geometry, ready for report.
    args:
      # source: A4_add_route_speeds.py
      urlpath: gs://calitp-analytics-data/data-analyses/bus_service_increase/routes_categorized_with_speed_{{analysis_date}}.parquet